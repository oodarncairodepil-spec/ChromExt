const testLogoData = "\x7b2274797065223a22427566666572222c2264617461223a5b3133372c38302c37382c37312c31332c31302c32362c31302c302c302c302c31332c37332c37322c36382c38322c302c302c302c36342c302c302c302c36342c382c362c302c302c302c3137302c3130352c3131332c3232322c302c302c302c392c3131322c37322c38392c3131352c302c302c31312c31392c302c302c31312c31392c312c302c3135342c3135362c32342c302c302c302c312c3131352c38322c37312c36362c302c3137342c3230362c32382c3233332c302c302c302c342c3130332c36352c37372c36352c302c302c3137372c3134332c31312c3235322c39372c352c302c302c392c3138312c37332c36382c36352c38342c3132302c312c3233372c39302c3132352c3130382c38352c3130332c32352c3235352c3135372c3134332c3235312c3231332c3230372c39312c3136382c36342c34312c39312c32372c3137382c3133332c3136342c34332c3134342c3230302c3139322c3139362c3134322c3131302c3131352c3230342c3130342c32302c37302c35302c36342c3135362c3131382c33352c3230392c34392c33392c3131382c3233342c3131362c3230392c3138342c3134352c3136382c33332c37302c35312c3234372c3133352c3232362c36382c39372c3132362c36352c31322c3134322c35382c36392c38302c3139352c3130302c33382c39312c392c3138342c35332c3139352c3139332c3231322c35382c32332c3136302c38302c38392c3136312c3137392c3136332c3232332c3233372c3235332c35362c33312c36322c3230372c3235312c3135382c3131352c3233382c3233372c3136352c3138332c3138302c3232392c3135362c3233342c3131342c3235312c37352c37382c3232322c3132332c3233392c3132312c3230372c3132332c3230372c3233392c3234372c36302c3233392c3234332c36322c3233392c3133352c39382c31392c38302c3139322c38302c38312c3232342c3135322c32312c302c352c3134322c38392c312c38302c3232342c3135322c32312c302c352c3134322c38392c312c38302c3232342c34302c3132302c312c3131362c3230342c33322c3233362c3235342c38312c3131332c312c31302c3231322c32372c34332c3136362c3234342c3130382c3131342c3232332c37332c33362c3131392c33302c372c3230322c3136332c382c35332c34362c3133342c3138322c3132342c33332c3138302c3231382c35362c3138302c3130312c31312c3131332c36312c382c39322c302c3232372c3134392c35352c3134352c3130362c3132312c32352c3139382c3234312c3137392c3137362c35382c3235302c39362c3135352c34322c3130382c36372c36352c3139342c3137362c39372c3231332c38372c3136312c3130302c39312c33352c3133382c38362c3232332c3134302c3131322c3230352c3232302c392c3231392c3230392c3130362c3136342c39362c3233302c3137372c31342c32342c3137332c3233312c3136302c34302c31302c3232302c3130352c3134302c37382c39382c3136382c3131362c36332c3231302c3232302c33322c3139362c3135332c31302c3134382c33322c33382c36372c3234362c3232342c382c38322c3139312c36302c3133382c3232382c34372c39342c3132382c3232312c3135312c33322c32312c35322c3132322c3131352c37332c3135362c37352c3139352c38342c34382c3130362c38382c32342c37372c3135352c37322c3135342c35342c38322c3139372c31372c3230342c3235332c3232302c372c38302c3138372c3235332c3135382c34392c3233372c3135322c3137352c3131392c33332c3131372c3136382c32392c3230312c3138392c33392c39372c3131372c3234362c38312c3139352c3230362c3137312c31382c3132312c3234372c3137392c31362c3133302c37342c3138312c36302c3133302c3137382c3138322c3230372c31312c33332c3136362c322c3232332c352c34382c37382c3138312c33352c3234312c3230352c36312c3137362c34362c3139302c36372c39352c38342c36352c3135322c37352c35392c3137312c3130302c3233352c33392c38382c302c3233312c37342c32342c33382c31382c3136362c3133332c38302c3235332c33342c3138382c3234372c3135332c3133352c3136312c3138392c3131362c312c3130352c33342c3135382c33382c3130372c31312c3136322c38392c3133322c3139392c3130332c3136312c3136302c3138382c3137332c3132312c39302c3232312c3139332c38372c312c3134362c36332c3235302c32352c3231302c34352c37312c3139382c3134342c3134392c33342c34302c3232322c3131392c3139352c3131332c3235352c3230392c32302c3134372c3138322c32392c312c34342c38382c38342c33392c3131302c3139372c38302c3130312c3134392c36352c35352c3131372c3133382c31382c3134322c3133392c37392c3133302c3132342c3234312c3135382c31332c3133362c35322c3137332c3139322c3131362c3232342c39312c31322c37322c3235332c3130362c36332c3134302c36332c32382c362c3139342c3234342c3233342c3136362c362c39312c3138312c3136382c33362c3234322c3137302c33352c3133322c37342c33362c37362c3231342c3139342c3133302c3136312c3231362c34382c36342c33372c31372c3134332c3136382c32362c3137302c3234342c31382c3134382c38382c31372c37312c34382c3137342c3130332c38322c3131392c3136312c3230372c3231342c342c3232382c32392c39372c39382c37392c3232302c35332c3130392c3234322c31322c3232332c342c34382c3134332c32392c33372c3234322c362c32302c36352c3231362c32322c33372c3136382c3138302c3133372c3138342c37342c33372c3230322c39382c38302c32372c3131302c3133332c35342c3139312c31382c39372c3133392c3232322c3235332c3233312c37312c38302c34392c39362c33322c3130362c3133342c3136382c36322c3132332c3133362c37332c3133302c38392c38342c39352c3131382c32372c36392c3230352c3234322c33322c3135352c3230312c3139342c3232352c3135372c392c3132362c3137372c3233372c3130372c37322c3132382c35332c3138342c33302c3234382c35352c31302c3136342c372c3136342c302c32362c352c36302c3137382c3137322c3130372c3132312c3137332c3130362c312c36362c3135392c3231362c342c3138392c39372c32312c3134382c3134362c33342c38382c3135312c3132332c3134342c3234382c3139382c3131302c3230342c34392c38322c33322c3234332c3134372c3136352c3135332c3138342c3233372c3132302c3133362c3233352c34312c3131382c37382c3136392c36362c3132372c3235352c37372c382c3137332c3137332c33352c3130372c3232332c3133382c3136312c3134312c3132332c3136312c3232332c3139302c3234382c3138362c3230312c35312c3132342c3133392c312c3136392c3235332c3138372c39362c32382c35372c3233322c352c36322c33382c33312c3138362c3234372c36322c3133322c35352c3132372c39322c3232302c3138332c3133352c3133352c3134352c3132362c3233382c3134332c37322c32392c35362c3232362c3134302c31322c3231372c34392c36362c3134392c34362c36332c33382c3131382c34302c32342c33332c33332c3233312c36302c3138362c31342c3134352c3133352c3131302c3133352c38322c33302c3234332c3235342c3133392c3133352c36352c3132352c3133382c3139352c39332c36322c3234382c3233302c312c3136312c3132332c3135342c3132382c3230392c33332c38382c3233312c3230372c322c3230392c35302c3133322c3231342c35352c36352c3137312c39312c34322c3233382c38392c32392c3233312c3134342c3231362c3234312c32392c38382c39332c36312c3134362c3130302c3135322c3138382c36382c3139362c382c32352c34332c39322c3135312c3233312c35302c3137332c34322c3233322c37332c3136362c3230382c3136372c3136342c34382c36362c3234312c39382c3233332c3231302c37342c36382c3137392c3230302c3133392c3135312c3234362c3133372c36302c36372c392c3132322c38312c3134382c3138392c33342c3234392c3231312c3130332c3137342c32362c31342c3131352c3137332c3135382c33382c3133392c3131392c33392c3134362c3233322c37382c33382c3136342c3230332c39312c35382c39332c32362c34322c38362c3231332c39392c3230312c3132392c3233372c382c31302c3132392c3230362c352c3231302c3133352c3234362c3231302c3233322c3234302c36372c34302c39372c3233342c3233312c32302c33312c35362c37302c3136382c38392c3135392c3234392c3131392c3131372c37382c342c3134352c3137332c3233352c38312c3132322c3234302c34312c39322c34312c3137372c31372c31302c38332c3131322c3131352c3137342c3136322c3133362c322c3232372c3137352c3131312c3139322c32362c32342c36352c38302c382c34342c32312c37382c36332c3138332c31392c3233302c31312c3139312c33332c3134362c3137302c32342c392c3136342c3135352c3138372c3132392c37372c31392c3132392c37392c39312c3131352c33392c3139342c3234372c3132352c31322c3233342c3235322c3132312c3232362c3135332c3231382c34352c3233352c3230392c3235332c3232372c3130332c3230312c3234322c31302c36362c3131362c3233332c3231322c35392c3234382c37342c3138302c3235332c31392c36392c3130372c3136362c36332c3231322c37372c3133322c36342c36302c3139322c35362c3235302c31392c3135322c33392c3135382c3136352c34302c37392c332c36332c39312c36302c39382c31302c3130372c3139352c34312c3231332c3233342c3138352c3133362c3233382c3231362c3132392c3233322c32332c3135352c36312c3234322c3134302c3234382c3230322c3130312c3130302c3131372c3137382c3132342c3134382c3139342c382c39332c34392c3139302c3230302c31312c3233362c35312c3135372c382c31302c3139302c3132332c3132382c3234392c3139382c3133392c34382c39312c3131392c37352c3230332c3231312c3138342c34362c3133312c3135352c3134372c32342c38312c39352c3231352c36332c3138342c312c3235302c3138362c372c3136302c32302c32312c39352c3234352c3130382c3233362c3130322c32362c3231382c39382c3231302c3233342c3138362c34312c37352c3134312c36312c3232392c36332c36312c382c31302c3139302c31312c39362c3235332c3234392c37332c32362c31382c31322c3134352c372c3133362c37362c38302c3136332c3130302c3230302c3134342c3133372c3134352c3139302c39372c32372c3234342c35392c35352c3233302c3132352c38362c34352c34312c37302c37332c3230352c3132342c34302c3135312c3132322c3133362c36302c36312c3139352c3234392c342c392c39372c3138392c3132352c32352c36352c3139332c38372c312c3137322c3234362c3133312c3137362c37312c35392c32392c3233352c3130332c33342c3138382c36362c3132352c39342c3232332c3235322c35332c3130342c34332c36322c3131342c3230352c35342c33342c3135362c33382c37302c3231372c39312c34302c3131392c33322c3234312c35362c35332c38362c3234382c3138332c3132382c3232342c3137352c302c33392c3131392c3230322c3139302c3233382c3138382c35362c39312c3134332c35312c35372c3233372c3138322c372c33392c36392c3135382c3136312c36392c34302c32392c3136362c35342c3130382c33392c37392c31362c3130392c3131332c3132372c382c382c3235342c392c3131322c3136352c3135372c3136362c3133312c3130302c3132352c3134352c3232322c3137382c3230332c39312c35302c3232362c38372c38342c36372c3138372c39392c3233352c3136342c3135352c3137372c3235312c3232332c3136322c3139322c3136392c3132322c3131352c31302c3234362c33322c35332c33392c31372c3234322c31392c3139302c392c39362c3138392c3235332c3137382c32342c3231392c3232392c3131322c37312c36352c37392c38332c3133322c32332c3130342c3137312c36332c35312c3234392c35342c34362c3135382c31372c33352c362c31312c3230302c3135382c33352c3233302c382c3232382c312c3230322c3139342c37342c342c352c3232332c342c38302c3231362c3235302c3232352c3233362c3135312c33392c31312c38322c34322c3137312c3232322c3137362c3131342c3231302c3130392c3231362c3130332c39352c3234332c3130322c3134382c3230382c35302c3135332c3136322c3138362c3138342c32322c36352c3139332c3139312c34362c39362c3234362c3130322c39342c3232322c3135332c31322c3133372c3230372c3134352c3231302c37332c35352c39372c3135362c3231362c3233392c3139372c31362c3231372c3134312c3130302c3232362c3136342c3231342c34352c36372c38302c3234302c34372c31372c34322c3137332c3135302c34312c3137352c3134372c3233362c34302c33332c38392c3231382c3138392c3233372c3134372c3132322c3232302c3132302c3131332c35352c34382c3132342c38312c3131382c3136332c3134342c37362c3134372c36392c3233342c37362c3231342c38372c34332c3233312c33352c34302c3234382c33392c36342c3138382c3232322c3230332c3233392c352c3133372c3133362c3230342c3234372c3233372c3234362c3136372c3137342c3234392c3136382c3132312c3132342c32332c3137322c31392c3138372c3130302c3231342c3233322c3133362c34302c3230302c38332c3136392c3232332c3131372c34372c3133302c3133322c3131312c322c34302c32312c31332c3134382c3232312c3134392c37322c31372c33342c38392c36382c3235302c3134322c31392c3138352c37392c312c33352c32332c3137352c3132322c3139382c3233342c3130362c3133312c3234312c3231392c372c39362c3138312c36312c37372c38362c3135312c3134372c33362c33332c3136302c3234302c302c31382c3131322c3232322c36302c3130342c3137312c36322c3134302c33322c3232352c3233392c3131362c3234382c3232332c3232332c3133302c3132352c3235342c3231392c3132312c3136372c3139302c3230322c3232302c362c37342c3131342c3131302c3133322c3230352c3130372c3132352c3131312c3138312c3230392c3139342c37322c3135312c37362c3134372c31332c3130332c3230392c3231322c3136322c3138362c3130352c33392c3132392c3232362c34312c3234312c33392c3234372c36342c3137332c31332c3130322c31382c3232382c3139342c39352c312c3230342c3132362c3232342c38342c32392c3233362c3139362c302c32302c34332c3133392c3231362c36382c34332c36332c37362c3231362c3131342c3132362c35352c35302c3232382c3231332c3234372c3132352c32322c39302c3139352c3139352c382c32362c3235342c34372c3133362c31322c3138322c322c3235352c3235302c3134342c38382c3231302c3137382c35372c3134372c31392c3135352c33332c39302c3133342c3131362c3138322c34302c3230362c3132352c35392c37312c32382c3131372c3139372c33352c3232382c3235302c3231392c34382c31392c382c3130322c36392c3136382c3134332c3135302c3139392c35392c34302c3235312c37352c3234372c3132332c32322c32392c36372c35302c3130372c3232312c34382c33352c31322c3131372c31372c34352c31342c3130312c3233332c32332c3136302c3231342c3131312c3139332c37362c33332c3138342c33372c3137372c3231322c352c3133382c392c3134332c312c3138392c3133352c3232392c3139382c3133362c33322c3137322c3132312c32372c33372c3135332c3137342c3136302c3133372c3130312c3131332c3130312c3230392c3130322c3136382c3138332c36302c31302c32302c34372c3139342c37362c33342c3234302c35332c36352c3134302c3138382c31342c3138382c3137392c3134332c3139382c3132302c34322c3133352c3235342c31342c35392c35372c33322c3133372c3233352c3138312c3138302c3234322c3137372c3135362c38362c3132332c34312c34382c34362c3136322c3134392c3232372c38302c32352c3235342c32332c382c39342c3132382c3235352c3131352c342c3138362c34302c3235302c3131302c36342c3136302c322c3234302c3234362c3131382c3232342c3233322c3136312c3233382c3234352c34322c37372c3135312c3138372c3132372c3132382c3233332c33322c34382c312c3132302c39352c3139312c3132372c3232392c3234372c34392c3234322c3136352c3232332c33352c3131322c36382c3130362c3130342c322c38352c3134322c3233332c39362c3139342c3231372c33322c3131312c36352c32352c3136372c3138372c3139362c38362c32322c33312c37332c392c3137352c3137312c3234332c3233382c3137372c3131372c3134312c38332c3135312c3233322c3138332c39312c3134342c3232302c3234372c3137302c3136382c31392c3138352c3132372c3133332c3131392c36342c33332c3131372c3234382c33312c3137382c31332c3233312c3134342c332c3233392c3233302c3136382c3234312c3136382c3231352c3131302c3235302c3136352c3131352c3136322c3131302c3133362c3234362c3234382c3232302c3130332c3138342c31332c3131302c3133392c3231392c37362c3234332c34312c31362c39302c382c31372c3235352c3135332c3136342c31372c3130312c3136382c38352c3135302c39372c33342c39312c3231342c34302c37352c37302c3139372c39302c3135332c3132382c3234312c3131312c34362c35362c32332c3232352c3232342c3130372c3234362c38312c3136302c3136352c3135332c3130302c3132342c39332c39342c3134322c3132312c3133312c33322c3135392c3230312c32352c3235342c3131362c3230332c3135322c3232332c3234382c302c36362c3233332c3230392c3137332c3133302c37322c3235352c3137302c3233392c3139332c36302c3132352c37332c3138382c3138382c3131372c3136312c3231352c3137312c38332c37302c3234372c3234392c3139372c3234392c3132362c35342c37342c39302c3135342c342c3137372c3132392c3138372c3131392c31312c312c39322c3234302c3234332c33372c3139312c3131302c3133302c37382c3130392c3138372c3235352c3230312c39382c3131332c32392c3130392c3132312c32312c3230322c3235352c3137382c352c3132302c3130392c3139332c3231362c3135312c39392c3130372c34372c3234392c3134372c33362c3139392c3137342c3230372c3139352c3233372c3139342c3139392c3233332c3132322c36362c3131382c3133372c3234332c35372c34332c38302c39322c3137352c3233382c3134392c3234312c3130342c3233302c3233392c322c3132342c3231342c3136362c3233322c3138372c33312c36392c3130352c3230332c3235332c3133302c32302c3139312c34302c39312c36312c3132352c37322c39302c3231342c3233382c37392c3133362c3134362c3131392c3130352c3138352c31342c3139312c34342c33352c3234352c3138372c3131382c3234312c3231372c3232312c3138352c3232392c3131382c3234382c3132312c3233332c34312c33392c352c34392c3138322c3130362c3235322c3230352c3137352c38302c3235312c3130372c3133332c3132302c3138352c3232312c3139362c3232312c3235322c34342c3136362c3235312c3133302c3130382c34352c37372c3134392c3131312c35382c36342c3136342c3135392c3135312c3231342c3130302c3133392c3131392c3233392c3134382c3134392c3231372c3230322c3231372c39362c37392c3138342c3232352c3230312c37362c3132352c3234362c32302c3234362c362c3234362c3133382c3131332c3134342c3138332c31312c3138342c3138372c3137372c34312c3133352c3137362c3130372c3233332c3130382c3130372c35312c39382c3230352c31332c3139342c35312c3136322c3235332c3136332c3139342c3132322c3234322c32302c32342c3231332c3137352c3137332c3234302c3135382c3131352c35352c35312c3234392c3137322c3134332c3231392c3138322c3234372c3135332c3138382c34312c3231392c33352c3232302c3130332c38382c3138302c3230342c39312c3139382c3130312c36362c3139372c34302c3136322c31332c3231352c3139302c36372c3234342c39382c3135372c32342c32332c3131302c34342c3131322c3233352c3131352c3132342c3232342c3136342c3134302c36392c34302c3130392c3139362c3136342c352c32342c3132362c3234302c3132382c3231352c3131392c3231372c3133382c37302c3135382c3133362c3137342c3134382c37372c3132352c3139332c3134362c3231392c38322c32382c33332c38392c36302c35352c35342c3138342c32342c3131352c3231302c3230332c3131372c3233332c3231362c35302c3231372c3232332c37312c3235342c35342c3131332c3232372c32392c31352c37332c3132392c3135322c3130382c3233332c3233342c3134302c3232392c3131352c36312c3139372c36352c39342c312c3135322c36302c3139352c3138312c3133322c3231372c3231372c34332c3235302c3235322c38342c39372c35372c33302c3139332c382c35372c3132352c3231392c3131352c3131312c3230302c38382c3134372c3132332c3138302c3130392c3230342c37332c3137352c36322c3139392c3134362c3231332c3231322c3139312c3232372c34342c3139322c3130352c37332c34382c33312c3234382c3135382c3133362c31372c3230372c35392c36382c35382c3136352c3133362c3132312c3134342c38372c302c35352c31362c31332c3131302c3232302c34332c3136322c3131352c3137342c3135352c39342c31312c3233382c3138352c36322c36322c3233372c3131372c33372c3234322c38352c33332c3130302c3138302c3234392c35342c3233392c3139322c39392c3130362c3135392c3233362c322c3232302c3234362c3133322c37312c39332c35362c3132382c3137372c382c3135372c3230362c3138382c39382c3136382c3131372c3232362c36332c3130322c3230332c3137392c3231332c3230372c3130382c3134362c3137372c39382c3131322c3232362c3235302c3231382c3231352c392c3232372c3232312c3232342c3232352c3133372c332c3135372c3131372c3132312c37322c3132342c3233302c3135312c342c38392c35312c3234362c3231362c32392c3231322c3131312c39392c3232362c3231302c3130362c3233302c33322c3138382c3130352c3138352c3136382c3137352c3231302c3131392c33382c31392c3132352c3136342c3132392c35342c36302c37352c3133332c32312c3134392c3133382c34302c3137332c31332c32342c3139342c3139342c32382c342c3231332c352c3136352c3136322c3232382c3134372c3136322c31322c3132352c3230312c3132332c3139362c3234332c34362c3132312c3131302c3133312c39392c3134302c3235312c33312c33302c33332c3135342c33372c3139342c3233322c3135302c3130312c3234352c3232372c3137382c34342c3138372c39312c3230342c33372c342c3139332c3139332c39392c3134322c3230332c35352c3230322c33322c3230302c3139362c3231312c3232312c3137382c31312c3234302c3230302c39362c3231302c3235322c3136332c3233342c3230332c3234322c3138352c32382c3138382c3138372c3233312c322c39332c35392c3130342c35322c3132302c39302c3234362c3131312c33302c34312c34322c3135352c34382c38352c3230342c3233322c38392c39372c3232332c3139332c3132352c3135372c3138372c382c39312c3132322c32362c3232382c32352c3137392c3137392c36352c32302c35362c3130322c352c36342c3132392c39392c38362c302c32302c35362c3130322c352c36342c3132392c3232372c3139312c3139332c3130352c3137332c3232362c3135312c3130302c3234322c38332c302c302c302c302c37332c36392c37382c36382c3137342c36362c39362c3133305d7d";

function parseLogoData(logoData) {
  if (!logoData) return undefined;
  
  try {
    // First, check if it's already a base64 string
    if (logoData.startsWith('data:image/')) {
      return logoData;
    }
    
    // Check if it's a hex-encoded JSON string (starts with \x7b which is {)
    if (logoData.startsWith('\\x7b') || logoData.includes('\\x')) {
      // Decode hex-encoded string - handle both \\x and \x formats
      let hexDecoded = logoData;
      
      // Handle double-escaped format \\x
      if (logoData.includes('\\\\x')) {
        hexDecoded = logoData.replace(/\\\\x([0-9a-fA-F]{2})/g, (match, hex) => {
          return String.fromCharCode(parseInt(hex, 16));
        });
      } else {
        // Handle single-escaped format \x
        hexDecoded = logoData.replace(/\\x([0-9a-fA-F]{2})/g, (match, hex) => {
          return String.fromCharCode(parseInt(hex, 16));
        });
      }
      
      console.log('Hex decoded:', hexDecoded.substring(0, 100));
      
      // Parse the decoded JSON
      const bufferData = JSON.parse(hexDecoded);
      if (bufferData.type === 'Buffer' && Array.isArray(bufferData.data)) {
        const uint8Array = new Uint8Array(bufferData.data);
        const base64String = btoa(String.fromCharCode(...uint8Array));
        return `data:image/png;base64,${base64String}`;
      }
    }
    
    // Try parsing as direct JSON (fallback for previous format)
    const bufferData = JSON.parse(logoData);
    if (bufferData.type === 'Buffer' && Array.isArray(bufferData.data)) {
      const uint8Array = new Uint8Array(bufferData.data);
      const base64String = btoa(String.fromCharCode(...uint8Array));
      return `data:image/png;base64,${base64String}`;
    }
  } catch (error) {
    console.error('Error parsing logo data:', error, 'Data preview:', logoData?.substring(0, 100));
  }
  
  return undefined;
}

console.log('Testing logo data parsing...');
console.log('Input data preview:', testLogoData.substring(0, 100));
const result = parseLogoData(testLogoData);
console.log('Result:', result ? 'Successfully parsed to base64' : 'Failed to parse');
if (result) {
  console.log('Result preview:', result.substring(0, 100));
}